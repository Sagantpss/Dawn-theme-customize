{% comment %} Custom Image Section {% endcomment %}
{{ 'base.css' | asset_url | stylesheet_tag }}
{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{%- endstyle -%}
<section>
  <div class="page-width">
  <h2>Custom image section</h2>
  <img
    srcset="
      {%- if section.settings.image.width >= 375 -%}{{ section.settings.image | image_url: width: 375 }} 375w,{%- endif -%}
      {%- if section.settings.image.width >= 750 -%}{{ section.settings.image | image_url: width: 750 }} 750w,{%- endif -%}
      {%- if section.settings.image.width >= 1100 -%}{{ section.settings.image | image_url: width: 1100 }} 1100w,{%- endif -%}
      {%- if section.settings.image.width >= 1500 -%}{{ section.settings.image | image_url: width: 1500 }} 1500w,{%- endif -%}
      {%- if section.settings.image.width >= 1780 -%}{{ section.settings.image | image_url: width: 1780 }} 1780w,{%- endif -%}
      {%- if section.settings.image.width >= 2000 -%}{{ section.settings.image | image_url: width: 2000 }} 2000w,{%- endif -%}
      {%- if section.settings.image.width >= 3000 -%}{{ section.settings.image | image_url: width: 3000 }} 3000w,{%- endif -%}
      {%- if section.settings.image.width >= 3840 -%}{{ section.settings.image | image_url: width: 3840 }} 3840w,{%- endif -%}
      {{ section.settings.image | image_url }} {{ section.settings.image.width }}w
    "
    sizes="100vw"
    src="{{ section.settings.image | image_url: width: 1500 }}"
    loading="lazy"
    alt="{{ section.settings.image.alt | escape }}"
    width="100%"
    height="100%"
  >
  {% if section.settings.image != blank %}
    {% assign height = section.settings.image.width | divided_by: section.settings.image.aspect_ratio | round %}
    {%- assign widths = '375, 550, 750, 1100, 1500' -%}
    {%- capture sizes -%}
      (min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 100 | divided_by: 2 }}px,
      (min-width: 750px) calc((100vw - 130px) / 2), calc((100vw - 50px) / 2)
    {%- endcapture -%}

   {{ section.settings.image |
    image_url: width: 1500 |
    image_tag:
      widths: widths,
      sizes: sizes,
      class: 'mobile-size-fix' }}

  {% endif %}
  </div>
</section>
{% schema %}
  {
    "name": "Custom image section",
    "settings": [
      {
        "type": "image_picker",
        "id": "image",
        "label": "Choose Image",
        "info": "Note:Choose best quality image and 500x500 px."
      }
    ],
    "presets": [
      {
        "name": "Custom image section"
      }
    ]
  }
{% endschema %}